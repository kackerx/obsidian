# 付款中心

## ov

- 谁下单谁付款, 所以直接流入订单负责人的付款申请
- 所以『付款认领』列表内全是==需求行==数据, ==采购下单分配==

## 付款认领

### 数据的流入
- 『需求』, 需求审批完成后以『需求行』纬度流入==pc_task==, 拿到自增id, 存入==pc_task_extra==的row_id, 1:1
- 『订单』而言, 一个订单行有一个==pc_task==对应一个==pc_task_extra==, 所以是1:N
- 『验收&退货』: ==task==表中会有一个且==parent_id==是对应的==order==的id

## 付款申请『待付款TASK』

### 需求行
『需求行』1:1

### 订单行
『订单&验收&退货』

## 付款申请单据

### DDL
- 『pc_order』: 主表, 
- 『pc_order_row』: 明细表, ==row_type== -> PR-需求行；PO-订单；GRN-验收行；RTN-退货行；M-物料
- 『contract』: 合同
- 『supplier』: 供应商

### tips
- 『付款申请单』数据来源共三大类: 
	- 需求行『需求-结算』
	- 采购单PO
	- 纯物料M

- 『付款申请单』种类分为==预付==和==后付==, 受是否验收控制, 无验收为预付, 有验收为后付, 只有数据来源为==采购单PO==的才会有有验收和无验收之分
	- 无验收预付单: 明细表只有PO单1:1
	- 有验收后付单: PO单携带==验收行==和==退货行==, 为1:N

- FSSC提交结算单时, 来源行扣减可结算金额, 可结算金额为0时, 流出『付款申请』task

![[Pasted image 20230128181958.png]]

### ov
- 需求行: 『付款申请单』可以包含不同PR的不同需求行
- 订单: 『付款申请单』中只能选择相同的==我方主体==, ==供应商==, ==币种==和==合同==
- 总金额 = 预付 + 后付