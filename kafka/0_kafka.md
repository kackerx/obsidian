# kafka #root 

> 一个流式的处理平台, 两大应用场景, <mark class="hltr-pink">消息队列</mark>: 建立实时流数据管道可靠的在系统程序间获取数据, <mark class="hltr-red">数据处理</mark>: 构建实时的流数据处理程序来处理数据流, 是pull模式, 消费者拉取

## 组件架构

- 主题层: 每个主题可以配置M个分区, 每个分区可以配置N个副本
- 分区层: 每个分区的N个副本有一个leader, 若干个follower
- 消息层: 每个分区包含若干条消息, 消息位移从0开始递增
- 客户端只能和分区的leader副本交互, follower副本只用于冗余和高可用

## 优势

- 性能: 设计大量应用批处理和异步的思想, 最高可以秒处理千万级消息, 高吞吐量
- 生态: 大数据和流计算领域生态良好

## 场景

- 页面pv, 曝光量, click事件统计数据
- 实时计算中的Dataflow Pipeline
- 业务消息队列, 发布订阅, 解耦服务, 削峰填谷, 异步通讯

## [[0_组件]]

## [[面试QA]]

## 存储原理

![[Pasted image 20221116145401.png|1000]]
- partition分布在多broker上, 所以partition的吞吐量和broker全集群的磁盘能力是正相关的(越多集群越强)

& 删除策略

![[Pasted image 20221116150222.png|500]]
- 集群保留所有发布过的message, 不管是否消费
- kafka提供可配置的保留策略(还有根据分区大小策略)
- 保留策略设置2天, 2天后被丢弃
- 每条消息都有一个offset, 第一条消息的偏移量, 消费者可以指定消费位置

& 实际存储

![[Pasted image 20221116150831.png|1000]]
![[Pasted image 20221116150909.png|1000]]
![[Pasted image 20221116151014.png|1000]]