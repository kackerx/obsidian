:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

1. Prepare阶段: TM给RM发送Prepare消息, 要么返回失败, 要么本地执行事务, 将事务写入本地『Redo和Undo』log文件, 此时未提交
2. Commit阶段: TM收到失败消息, 让执行成功的RM进行回滚, 否则发送commit消息
3. RM根据commit消息执行回滚或提交, 释放<mark class="hltr-blue">锁资源</mark>

~~~ad-danger
title: 问题

- 同步阻塞: 事务处理过程, 参与事务节点对其公共资源加锁
- 单点故障: TM单点故障, RM阻塞
- 不一致: Commit阶段, 网络问题或部分RM故障
~~~

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

![[Pasted image 20240427201426.png|666]]

![[Pasted image 20240427201618.png|666]]

![[Pasted image 20240427201653.png|666]]
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
