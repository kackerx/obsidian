:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

~~~ad-primary
title: 服务的定义

- 结构体依赖Repo和领域服务的引用
- 每个服务方法对应了业务中的一个实例
- 表达用例和用户故事, 暴露系统的全部功能
- 负责编排和转发和业务用例的执行顺序, 及结果的拼装, 隐藏领域层的复杂性和内部实现
- 比较薄, 安全认证, 权限校验, 持久化事务, 消息通知, 创建邮件等
~~~

~~~ad-success
title: 服务方法入参

- DTO, 进一步划分为Command和Query(CQRS)
- grpc的proto对象
- 不要将DTO对象传播到领域层, 转换成领域对象去调用
~~~

~~~ad-note
title: 服务方法出参

- DTO返回: 多余大量对象, GC负担, 在<mark class="hltr-blue">cqe</mark>中存放command, query, event多种不同的DTO, <mark class="hltr-pink">assemlber</mark>来存放转换函数
- DPO: 持有私有属性的领域模型引用, 不同于dto的把定义和组装拆到两个地方, 可以只关注DPO自身
- 直接使用Grpc定义的resp
~~~

~~~ad-bug
title: 对象转换

- 应用服务方法中, dto和entity互转, converter方法定义在assembler目录, dto定义在cqe(command, query, event)
- 应用服务调用领域层的方法时, 要转成entity, 或者转成聚合根(domain/agg/下定义)传参
~~~

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

![[Pasted image 20240428171038.png]]

服务定义

![[Pasted image 20240428180517.png]]

服务方法的出参转换

![[Pasted image 20240428180800.png]]

DPO

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

---
:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

~~~ad-primary
title: 领域事件的消费

~~~

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

todo

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

---
:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

~~~ad-primary
title: 事务和安全的处理

- DDD的原则: 一个业务用例 --> 一个事务 --> 一个聚合根
~~~

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::



::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
