
| -w          | 文件名                    | -w file.pcap                                                                  | 报文保存到文件                            |
| :---------- | :--------------------- | :---------------------------------------------------------------------------- | :--------------------------------- |
| -c          | 数量                     |                                                                               | 抓取固定数量报文                           |
| -s          |                        | -s 74 -w x.pcap<div>只抓取tcp头部的话</div><div>帧头(14) + ip头(20) + tcp头(20-40)</div> | 抓取一定长度的报文                          |
| -n          |                        |                                                                               | 不做地址转换, ip -&gt; 主机, 80 -&gt; http |
| -v/-vv/-vvv |                        |                                                                               | 详细报文信息                             |
| -e          |                        |                                                                               | 打印二层信息, 特别是MAC                     |
| -p          |                        |                                                                               | 关闭混杂模式, 也就是嗅探(Sniffering)          |
| -X          |                        |                                                                               |                                    |
| -i          | 网卡号(tcpdump -D获取设备的序号) | -i any, 抓取全部接口消息                                                              | 指定抓包的端口号或名称                        |
| host        | 目的ip                   |                                                                               |                                    |

---
## ex

1. tcpdump -w file.pcap 'tcp[13]&4 != 0' // tcp的第13个字节(标志位), 第四个标记RST为1
2. tcpdump -pne -i 
3. 混杂模式(Promisc mode): 网卡会接收经过它的所有帧发到cpu, 非混杂模式下网卡只会接收目的MAC地址是自己的单播帧, 以及多播和广播帧