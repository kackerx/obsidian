:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

~~~ad-grey
title:  

1. 对称加密算法有两种, 『流密码算法(stream ciphers)』和『块密码算法(block ciphers)』
~~~

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

![[Pasted image 20240305114738.png| 777]]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

## 块密码模式 - 迭代模式(分组模式)


:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

~~~ad-primary
title: ECB

1. 明文拆块, 每个块是分组长度, 最后一块小于分组长度则填充
2. 对每个块执行加密, 最后组合
3. 密文拆块, 每个块是分组长度, 最后一块去除填充值
4. 对每个块解密, 最后组合
~~~

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

![[Pasted image 20240305120521.png|555]]

![[Pasted image 20240305120533.png|555]]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

~~~ad-success
title: CBC

1. 生成一个初始随机向量IV, 初始化向量和第一个分组块进行XOR, 运算的结果经过key加密得到一个密文分组
2. 第n个分组数据块和前一个密文分组进行XOR运算, 结果加密, 组合
3. 对于解密, 密文多个数据块, 初始化向量和第一个数据块进行XOR运算, 运算的结果经过key解密得到第一个明文分组
4. 第n个分组密文块和前一个密文分组进行XOR运算, 结果解密, 组合
~~~

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

![[Pasted image 20240305140224.png|555]]

![[Pasted image 20240305140234.png|555]]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

~~~ad-warn
title: CTR (counter)计数器模式

1. 生成密钥流, 各个秘钥流之间有关系, 最简单的密钥流就是每块+1
2. 拆成多个数据块且不需要填充, 先生成密钥流, n个数据块就有n个密钥流, 根据第n个密钥流可以得到第n+1个密钥流(最简单方式递增+1)
3. 第一个密钥流就是生成一个随机值(Nonce)
4. 密钥和密钥流同时处理加密, 后的值和数据块进行XOR运算得到密文分组
~~~

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

![[Pasted image 20240305141425.png|555]]

![[Pasted image 20240305141746.png|555]]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
## 块密码模式 - 填充标准

:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

~~~ad-tips
title: 填充方式

1. zero填充, 最后一个数据块分组的长度不足时补零, 问题是如果最后一位明文本身就是0没法判断
2. PKCS#7填充, 缺少几位最后全部填充几, 01|0202|030303
3. AES-128-CBC-PKCS#7: aes的密钥长度128, 默认分组长度128, CBC分组模式, 填充标准PKCS#7
~~~

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::



::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::