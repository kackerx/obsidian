## ov
:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

1. MAC(Message Authentication Code): 消息验证码, hash算法只能保证消息的完整性校验, 由于中间人攻击所以没法保证消息是否篡改
2. 对称加密算法同理, 通常结合MAC一起使用, 前者保证消息的机密性, 后者保证消息的完整性(未被篡改)
3. 特点: 证明消息没被篡改这点和hash类似, 消息是正确的发送者发送的也就是说消息是经过验证的
4. MAC = mac(消息, 秘钥)
5. 如图, 前者hash随便更改内容, 后者需要双方提前都有密钥, 中间人不能知道, 所以没法加解密消息

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

![[Pasted image 20240305152236.png|555]]

![[Pasted image 20240305152555.png|555]]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::


## MAC算法实现

:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=2 largest-column=firs}

1. MAC算法有两种, 『CBC-MAC』和『HMAC』, 前者简单说就是对称加密的CBC分组模式下最后一个密文分组的值就是MAC值
2. HMAC(Hash-based Message Authentication Code): 使用hash为加密基元, 常见的有HMAC-SHA-1, HMAC-SHA256, HMAC-SHA512

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

![[Pasted image 20240305153800.png|555]]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::


## AD加密模式 - (Authenticated Encryption)

:::::::::::::::::::::::::::::::::::::::: {.columns shadow=off border=off col-count=3 largest-column=firs}

- Encrypt-and-MAC(E&M): 对消息分别进行加密和MAC, 结果结合起来发送

![[Pasted image 20240305154609.png|555]]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

- MAC-then-Encrypt(MtE): 先对消息进行MAC, 消息和MAC一起进行加密, 密文发送给接收方
- HTTPS一般使用这种模式比如AES-128-CBC#PKCS7-HMAC-SHA256

![[Pasted image 20240305154653.png|555]]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::columnbreak
:::

- Encrypt-then-MAC(EtM): 先对消息加密, 然后密文计算MAC, 密文 + MAC --> 接收方

![[Pasted image 20240305154826.png|555]]

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
